"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[3959],{35285:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>t,metadata:()=>r,toc:()=>d});var o=s(74848),i=s(15680);const t={id:"interactive_console",title:"Buck2 Consoles"},l=void 0,r={id:"users/build_observability/interactive_console",title:"Buck2 Consoles",description:"Buck2 offers several console types for build-like commands (e.g. build,",source:"@site/../docs/users/build_observability/interactive_console.md",sourceDirName:"users/build_observability",slug:"/users/build_observability/interactive_console",permalink:"/docs/users/build_observability/interactive_console",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{id:"interactive_console",title:"Buck2 Consoles"},sidebar:"main",previous:{title:"Why is Buck2 hanging?",permalink:"/docs/users/faq/buck_hanging"},next:{title:"Logging",permalink:"/docs/users/build_observability/logging"}},c={},d=[{value:"Simpleconsole",id:"simpleconsole",level:2},{value:"Demo",id:"demo",level:3},{value:"Superconsole",id:"superconsole",level:2},{value:"Demo",id:"demo-1",level:3},{value:"Toggles",id:"toggles",level:3},{value:"No console",id:"no-console",level:2}];function a(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",ul:"ul",...(0,i.useMDXComponents)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(n.p,{children:["Buck2 offers several console types for build-like commands (e.g. ",(0,o.jsx)(n.code,{children:"build"}),",\n",(0,o.jsx)(n.code,{children:"install"}),", ",(0,o.jsx)(n.code,{children:"test"}),", etc.). The console is always written to stderr."]}),"\n",(0,o.jsxs)(n.p,{children:["The console can be specified via the ",(0,o.jsx)(n.code,{children:"--console"})," flag, or the ",(0,o.jsx)(n.code,{children:"BUCK_CONSOLE"})," env\nvariable. The default console type is ",(0,o.jsx)(n.code,{children:"auto"}),". Supported ",(0,o.jsx)(n.code,{children:"--console"})," types:"]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"auto"})," - Default console type. Auto defaults to the superconsole if the stderr\nis a TTY. Otherwise will uses simple console"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"simple"})," - Build a simpleconsole with TTY, if TTY is supported by the OS. See\n",(0,o.jsx)(n.a,{href:"#simpleconsole",children:"Simpleconsole"})]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"simplenotty"})," - Build a simpleconsole without TTY. See\n",(0,o.jsx)(n.a,{href:"#simpleconsole",children:"Simpleconsole"})]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"simpletty"})," - Build a simpleconsole with TTY. See\n",(0,o.jsx)(n.a,{href:"#simpleconsole",children:"Simpleconsole"})]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"super"})," - Build a superconsole regardless of whether stderr is a TTY. See\n",(0,o.jsx)(n.a,{href:"#superconsole",children:"Superconsole"})]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"none"})," - See ",(0,o.jsx)(n.a,{href:"#no-console",children:"No console"})]}),"\n"]}),"\n",(0,o.jsxs)(n.p,{children:["If ",(0,o.jsx)(n.code,{children:"simplenotty"})," or ",(0,o.jsx)(n.code,{children:"none"})," are specified, or if TTY is not supported by the OS,\nthen we strip out any color within the error messages."]}),"\n",(0,o.jsx)(n.p,{children:"All console options will output the build result, whether succeeded or not, to\nstdout. Note that action execution stderr is hidden if the build succeeded."}),"\n",(0,o.jsx)(n.p,{children:"The simple and superconsole will also print metadata about the build itself,\nsuch as the Buck2 UUID, the percentage of cache hits, and the number of action\ncommands ran. In addition, they will print the event spans detected within the\nbuild."}),"\n",(0,o.jsx)(n.h2,{id:"simpleconsole",children:"Simpleconsole"}),"\n",(0,o.jsx)(n.p,{children:"The simpleconsole prints the stdout/stderr messages and event spans, line by\nline. There is no resource usage telemetry emitted."}),"\n",(0,o.jsx)(n.h3,{id:"demo",children:"Demo"}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{alt:"Simpleconsole running a build",src:s(51342).A+"",width:"1006",height:"266"})}),"\n",(0,o.jsx)(n.h2,{id:"superconsole",children:"Superconsole"}),"\n",(0,o.jsxs)(n.p,{children:["The superconsole uses the\n",(0,o.jsx)(n.a,{href:"https://github.com/facebookincubator/superconsole",children:"superconsole"})," library to\nprovide an interactive console which shows the event spans going on within\nBuck2."]}),"\n",(0,o.jsx)(n.h3,{id:"demo-1",children:"Demo"}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{alt:"Superconsole running a build",src:s(46781).A+"",width:"1465",height:"452"})}),"\n",(0,o.jsx)(n.h3,{id:"toggles",children:"Toggles"}),"\n",(0,o.jsx)(n.p,{children:"The superconsole also provides several toggles to inspect ongoing Buck2\ntelemetry."}),"\n",(0,o.jsxs)(n.p,{children:["To see what's available you can press ",(0,o.jsx)(n.code,{children:"?"})," or ",(0,o.jsx)(n.code,{children:"h"}),". This will work as long as\nstdin is a TTY, which will be true most of the time if you're not piping\nanything into Buck2. To disable to allow alternate use of stdin, or for follow\nup pasted commands to not get swallowed, you can set the\n",(0,o.jsx)(n.code,{children:"BUCK_NO_INTERACTIVE_CONSOLE"})," environment variable, or use the flag\n",(0,o.jsx)(n.code,{children:"--no-interactive-console"}),"."]}),"\n",(0,o.jsx)(n.p,{children:"We support the following toggles:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"c"})," - toggle commands (shown in superconsole by default)"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"d"})," - toggle DICE key states"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"e"})," - toggle debugging events, such as spans and instant event counts"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"2"})," - toggle two lines mode when showing events"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"r"})," - toggle detailed remote execution info, such as uploads, downloads, and\naction cache calls"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"i"})," - toggle I/O counters"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"p"})," - display target configurations"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"+"})," - show more lines"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"-"})," - show fewer lines"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"h"})," - show help"]}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"Note: Not available yet for Windows"}),"\n",(0,o.jsx)(n.h2,{id:"no-console",children:"No console"}),"\n",(0,o.jsxs)(n.p,{children:["When specifying the ",(0,o.jsx)(n.code,{children:"none"})," console type, Buck2 will only print if the build\nsucceeded, or the error if the build failed."]})]})}function h(e={}){const{wrapper:n}={...(0,i.useMDXComponents)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(a,{...e})}):a(e)}},15680:(e,n,s)=>{s.r(n),s.d(n,{MDXContext:()=>d,MDXProvider:()=>u,mdx:()=>j,useMDXComponents:()=>h,withMDXComponents:()=>a});var o=s(96540);function i(e,n,s){return n in e?Object.defineProperty(e,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[n]=s,e}function t(){return t=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(e[o]=s[o])}return e},t.apply(this,arguments)}function l(e,n){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),s.push.apply(s,o)}return s}function r(e){for(var n=1;n<arguments.length;n++){var s=null!=arguments[n]?arguments[n]:{};n%2?l(Object(s),!0).forEach((function(n){i(e,n,s[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):l(Object(s)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(s,n))}))}return e}function c(e,n){if(null==e)return{};var s,o,i=function(e,n){if(null==e)return{};var s,o,i={},t=Object.keys(e);for(o=0;o<t.length;o++)s=t[o],n.indexOf(s)>=0||(i[s]=e[s]);return i}(e,n);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);for(o=0;o<t.length;o++)s=t[o],n.indexOf(s)>=0||Object.prototype.propertyIsEnumerable.call(e,s)&&(i[s]=e[s])}return i}var d=o.createContext({}),a=function(e){return function(n){var s=h(n.components);return o.createElement(e,t({},n,{components:s}))}},h=function(e){var n=o.useContext(d),s=n;return e&&(s="function"==typeof e?e(n):r(r({},n),e)),s},u=function(e){var n=h(e.components);return o.createElement(d.Provider,{value:n},e.children)},p="mdxType",f={inlineCode:"code",wrapper:function(e){var n=e.children;return o.createElement(o.Fragment,{},n)}},m=o.forwardRef((function(e,n){var s=e.components,i=e.mdxType,t=e.originalType,l=e.parentName,d=c(e,["components","mdxType","originalType","parentName"]),a=h(s),u=i,p=a["".concat(l,".").concat(u)]||a[u]||f[u]||t;return s?o.createElement(p,r(r({ref:n},d),{},{components:s})):o.createElement(p,r({ref:n},d))}));function j(e,n){var s=arguments,i=n&&n.mdxType;if("string"==typeof e||i){var t=s.length,l=new Array(t);l[0]=m;var r={};for(var c in n)hasOwnProperty.call(n,c)&&(r[c]=n[c]);r.originalType=e,r[p]="string"==typeof e?e:i,l[1]=r;for(var d=2;d<t;d++)l[d]=s[d];return o.createElement.apply(null,l)}return o.createElement.apply(null,s)}m.displayName="MDXCreateElement"},51342:(e,n,s)=>{s.d(n,{A:()=>o});const o=s.p+"assets/images/simpleconsole-5bfa37b932256fce081a21ce4f4c4b92.gif"},46781:(e,n,s)=>{s.d(n,{A:()=>o});const o=s.p+"assets/images/superconsole-71265cd99fd66f981336092604efff94.gif"}}]);