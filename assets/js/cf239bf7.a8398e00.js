"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[4529],{53465:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>s,contentTitle:()=>c,default:()=>p,frontMatter:()=>i,metadata:()=>l,toc:()=>a});var t=r(74848),o=r(15680);const i={},c="Return error in ProviderCollection[] on undeclared provider",l={id:"rfcs/implemented/provider-collection-at",title:"Return error in ProviderCollection[] on undeclared provider",description:"Currently, ctx.attrs.foo[UnknownInfo] returns None if foo is a provider",source:"@site/../docs/rfcs/implemented/provider-collection-at.md",sourceDirName:"rfcs/implemented",slug:"/rfcs/implemented/provider-collection-at",permalink:"/docs/rfcs/implemented/provider-collection-at",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{}},s={},a=[{value:"Why",id:"why",level:2},{value:"Bazel",id:"bazel",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,o.useMDXComponents)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsxs)(n.h1,{id:"return-error-in-providercollection-on-undeclared-provider",children:["Return error in ",(0,t.jsx)(n.code,{children:"ProviderCollection[]"})," on undeclared provider"]})}),"\n",(0,t.jsxs)(n.p,{children:["Currently, ",(0,t.jsx)(n.code,{children:"ctx.attrs.foo[UnknownInfo]"})," returns ",(0,t.jsx)(n.code,{children:"None"})," if ",(0,t.jsx)(n.code,{children:"foo"})," is a provider\ncollection."]}),"\n",(0,t.jsx)(n.p,{children:"This RFC proposes these changes:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"ctx.attrs.foo[UnknownInfo]"})," is an error"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"UnknownInfo in ctx.attrs.foo"})," is ",(0,t.jsx)(n.code,{children:"False"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"ctx.attrs.foo.get(UnknownInfo)"})," returns ",(0,t.jsx)(n.code,{children:"None"})]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"why",children:"Why"}),"\n",(0,t.jsx)(n.p,{children:"Better diagnostics when accessing unknown provider. E. g. when writing:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:"ctx.attrs.foo[UnknownInfo].bar\n"})}),"\n",(0,t.jsx)(n.p,{children:"Currently, the error is:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"Object of type `NoneType` has no attribute `bar`\n"})}),"\n",(0,t.jsx)(n.p,{children:"Instead, the error will be something like:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"provider collection does not contain `UnknownInfo`,\n    defined providers are `FooInfo`, `BarInfo`.\n"})}),"\n",(0,t.jsx)(n.h2,{id:"bazel",children:"Bazel"}),"\n",(0,t.jsxs)(n.p,{children:["In bazel, ",(0,t.jsx)(n.code,{children:"[]"})," on unknown provider is an error, like this:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"Error: <target //optional_provider:n2> (rule '_sum')\n    doesn't contain declared provider 'UnknownInfo'\n"})})]})}function p(e={}){const{wrapper:n}={...(0,o.useMDXComponents)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},15680:(e,n,r)=>{r.r(n),r.d(n,{MDXContext:()=>a,MDXProvider:()=>u,mdx:()=>m,useMDXComponents:()=>p,withMDXComponents:()=>d});var t=r(96540);function o(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function i(){return i=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=r[t])}return e},i.apply(this,arguments)}function c(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,t)}return r}function l(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?c(Object(r),!0).forEach((function(n){o(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function s(e,n){if(null==e)return{};var r,t,o=function(e,n){if(null==e)return{};var r,t,o={},i=Object.keys(e);for(t=0;t<i.length;t++)r=i[t],n.indexOf(r)>=0||(o[r]=e[r]);return o}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(t=0;t<i.length;t++)r=i[t],n.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var a=t.createContext({}),d=function(e){return function(n){var r=p(n.components);return t.createElement(e,i({},n,{components:r}))}},p=function(e){var n=t.useContext(a),r=n;return e&&(r="function"==typeof e?e(n):l(l({},n),e)),r},u=function(e){var n=p(e.components);return t.createElement(a.Provider,{value:n},e.children)},f="mdxType",h={inlineCode:"code",wrapper:function(e){var n=e.children;return t.createElement(t.Fragment,{},n)}},j=t.forwardRef((function(e,n){var r=e.components,o=e.mdxType,i=e.originalType,c=e.parentName,a=s(e,["components","mdxType","originalType","parentName"]),d=p(r),u=o,f=d["".concat(c,".").concat(u)]||d[u]||h[u]||i;return r?t.createElement(f,l(l({ref:n},a),{},{components:r})):t.createElement(f,l({ref:n},a))}));function m(e,n){var r=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var i=r.length,c=new Array(i);c[0]=j;var l={};for(var s in n)hasOwnProperty.call(n,s)&&(l[s]=n[s]);l.originalType=e,l[f]="string"==typeof e?e:o,c[1]=l;for(var a=2;a<i;a++)c[a]=r[a];return t.createElement.apply(null,c)}return t.createElement.apply(null,r)}j.displayName="MDXCreateElement"}}]);