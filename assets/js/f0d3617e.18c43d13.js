"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[6981],{22136:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>s,contentTitle:()=>i,default:()=>p,frontMatter:()=>c,metadata:()=>a,toc:()=>u});var t=r(74848),o=r(15680);const c={id:"configurations",title:"Configurations"},i=void 0,a={id:"concepts/configurations",title:"Configurations",description:"For rule authors see also: Configurations",source:"@site/../docs/concepts/configurations.md",sourceDirName:"concepts",slug:"/concepts/configurations",permalink:"/docs/concepts/configurations",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{id:"configurations",title:"Configurations"},sidebar:"main",previous:{title:".buckconfig",permalink:"/docs/concepts/buckconfig"},next:{title:"Glossary of Terms",permalink:"/docs/concepts/glossary"}},s={},u=[];function l(e){const n={a:"a",code:"code",p:"p",pre:"pre",...(0,o.useMDXComponents)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n.p,{children:["For rule authors see also: ",(0,t.jsx)(n.a,{href:"/docs/rule_authors/configurations",children:"Configurations"})]}),"\n",(0,t.jsxs)(n.p,{children:['When building a target, buck always builds it in a particular "configuration."\nThe configuration typically includes information like the target os, target\narch, sanitizers, opt level, etc. One way to understand the effect that a\nconfiguration has is via the ',(0,t.jsx)(n.code,{children:"cquery"})," and ",(0,t.jsx)(n.code,{children:"uquery"})," commands. The cquery command\nwill compute the appropriate configuration for a target and display a version of\nthat target's attributes with the configuration applied. The ",(0,t.jsx)(n.code,{children:"uquery"})," command\nwill not apply a configuration."]}),"\n",(0,t.jsxs)(n.p,{children:["Here is a heavily trimmed version of the outputs of invoking ",(0,t.jsx)(n.code,{children:"uquery"})," and\n",(0,t.jsx)(n.code,{children:"cquery"})," on ",(0,t.jsx)(n.code,{children:"//buck2/app/buck2_core:buck2_core"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'> buck2 uquery -A \'"//buck2/app/buck2_core:buck2_core"\'\n{\n  "fbcode//buck2/app/buck2_core:buck2_core": {\n    "buck.type": "rust_library",\n    "buck.package": "fbcode//buck2/app/buck2_core:TARGETS",\n    "name": "buck2_core",\n    "visibility": [\n      "PUBLIC"\n    ],\n    "deps": {\n      "fbsource//third-party/rust:anyhow",\n      "fbsource//third-party/rust:arc-swap",\n      "fbsource//third-party/rust:blake3",\n      "fbsource//third-party/rust:compact_str",\n      "fbsource//third-party/rust:dashmap",\n      {\n        "__type": "selector",\n        "entries": {\n          "DEFAULT": [],\n          "ovr_config//os:windows": [\n            "fbsource//third-party/rust:common-path"\n          ]\n        }\n      },\n      {\n        "__type": "selector",\n        "entries": {\n          "DEFAULT": [],\n          "ovr_config//os:linux": [\n            "fbsource//third-party/rust:nix"\n          ]\n        }\n      },\n    },\n  }\n}\n'})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'> buck2 cquery -A \'"//buck2/app/buck2_core:buck2_core"\'\n{\n  "fbcode//buck2/app/buck2_core:buck2_core (ovr_config//platform/linux:<OMITTED>)": {\n    "buck.type": "rust_library",\n    "buck.package": "fbcode//buck2/app/buck2_core:TARGETS",\n    "buck.target_configuration": "ovr_config//platform/linux:<OMITTED>",\n    "buck.execution_platform": "fbcode//buck2/platform/<OMITTED>",\n    "name": "buck2_core",\n    "visibility": [\n      "PUBLIC"\n    ],\n    "deps": [\n      "fbsource//third-party/rust:anyhow (ovr_config//platform/linux:<OMITTED>)",\n      "fbsource//third-party/rust:arc-swap (ovr_config//platform/linux:<OMITTED>)",\n      "fbsource//third-party/rust:blake3 (ovr_config//platform/linux:<OMITTED>)",\n      "fbsource//third-party/rust:compact_str (ovr_config//platform/linux:<OMITTED>)",\n      "fbsource//third-party/rust:dashmap (ovr_config//platform/linux:<OMITTED>)",\n      "fbsource//third-party/rust:nix (ovr_config//platform/linux:<OMITTED>)"\n    ]\n}\n'})}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"cquery"})," output has additional ",(0,t.jsx)(n.code,{children:"buck.target_configuration"})," and\n",(0,t.jsx)(n.code,{children:"buck.execution_platform"})," attributes which tell you what the target is being\nbuilt for and what it's being built on, respectively. ",(0,t.jsx)(n.code,{children:"uquery"})," doesn't have\nthose."]}),"\n",(0,t.jsxs)(n.p,{children:["The deps in ",(0,t.jsx)(n.code,{children:"uquery"})," also have a number of selects; these indicate that the\n",(0,t.jsx)(n.code,{children:"common-path"})," dependency should only be included when building for Windows,\nwhile the ",(0,t.jsx)(n.code,{children:"nix"})," dependency is needed only for Linux. In ",(0,t.jsx)(n.code,{children:"cquery"})," that\ndistinction has been resolved; because the target has been configured for Linux,\nthe ",(0,t.jsx)(n.code,{children:"nix"})," dependency is present and indistinguishable from any other, while the\n",(0,t.jsx)(n.code,{children:"common-path"})," dependency is gone."]})]})}function p(e={}){const{wrapper:n}={...(0,o.useMDXComponents)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(l,{...e})}):l(e)}},15680:(e,n,r)=>{r.r(n),r.d(n,{MDXContext:()=>u,MDXProvider:()=>d,mdx:()=>y,useMDXComponents:()=>p,withMDXComponents:()=>l});var t=r(96540);function o(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function c(){return c=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=r[t])}return e},c.apply(this,arguments)}function i(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,t)}return r}function a(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?i(Object(r),!0).forEach((function(n){o(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function s(e,n){if(null==e)return{};var r,t,o=function(e,n){if(null==e)return{};var r,t,o={},c=Object.keys(e);for(t=0;t<c.length;t++)r=c[t],n.indexOf(r)>=0||(o[r]=e[r]);return o}(e,n);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(t=0;t<c.length;t++)r=c[t],n.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var u=t.createContext({}),l=function(e){return function(n){var r=p(n.components);return t.createElement(e,c({},n,{components:r}))}},p=function(e){var n=t.useContext(u),r=n;return e&&(r="function"==typeof e?e(n):a(a({},n),e)),r},d=function(e){var n=p(e.components);return t.createElement(u.Provider,{value:n},e.children)},f="mdxType",h={inlineCode:"code",wrapper:function(e){var n=e.children;return t.createElement(t.Fragment,{},n)}},b=t.forwardRef((function(e,n){var r=e.components,o=e.mdxType,c=e.originalType,i=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),l=p(r),d=o,f=l["".concat(i,".").concat(d)]||l[d]||h[d]||c;return r?t.createElement(f,a(a({ref:n},u),{},{components:r})):t.createElement(f,a({ref:n},u))}));function y(e,n){var r=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var c=r.length,i=new Array(c);i[0]=b;var a={};for(var s in n)hasOwnProperty.call(n,s)&&(a[s]=n[s]);a.originalType=e,a[f]="string"==typeof e?e:o,i[1]=a;for(var u=2;u<c;u++)i[u]=r[u];return t.createElement.apply(null,i)}return t.createElement.apply(null,r)}b.displayName="MDXCreateElement"}}]);