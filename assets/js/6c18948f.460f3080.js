"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[7640],{52681:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>s,default:()=>h,frontMatter:()=>i,metadata:()=>a,toc:()=>d});var r=t(74848),o=t(15680),c=t(86025);const i={id:"key_concepts",title:"Key Concepts"},s="Key concepts",a={id:"concepts/key_concepts",title:"Key Concepts",description:"Buck2 has a number of fundamental concepts:",source:"@site/../docs/concepts/key_concepts.md",sourceDirName:"concepts",slug:"/concepts/key_concepts",permalink:"/docs/concepts/key_concepts",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{id:"key_concepts",title:"Key Concepts"},sidebar:"main",previous:{title:"Bootstrapping Buck2",permalink:"/docs/about/bootstrapping"},next:{title:"Concept Map",permalink:"/docs/concepts/concept_map"}},l={},d=[{value:"Buck2&#39;s dependency graph",id:"buck2s-dependency-graph",level:3},{value:"Multiple Buck2 projects in a single repository",id:"multiple-buck2-projects-in-a-single-repository",level:3},{value:"See also",id:"see-also",level:3}];function u(e){const n={a:"a",code:"code",em:"em",h1:"h1",h3:"h3",header:"header",li:"li",p:"p",strong:"strong",ul:"ul",...(0,o.useMDXComponents)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"key-concepts",children:"Key concepts"})}),"\n",(0,r.jsx)(n.p,{children:"Buck2 has a number of fundamental concepts:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["A ",(0,r.jsx)(n.a,{href:"/docs/concepts/build_rule",children:(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.em,{children:"build rule"})})})," describes how to produce an output file\nfrom a set of input files. Most build rules are specific to a particular\nlanguage or platform. For example, you would use the\n",(0,r.jsx)(n.a,{href:"../../prelude/globals/#cxx_binary",children:(0,r.jsx)(n.code,{children:"cxx_binary"})})," rule to create a C++ binary,\nbut you would use the\n",(0,r.jsx)(n.a,{href:"../../prelude/globals/#android_binary",children:(0,r.jsx)(n.code,{children:"android_binary"})})," rule to create an\nAndroid APK."]}),"\n",(0,r.jsxs)(n.li,{children:["A ",(0,r.jsx)(n.a,{href:"/docs/concepts/build_target",children:(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.em,{children:"build target"})})})," is a string that uniquely identifies a\nbuild rule. It can be thought of as a URI for the build rule within the Buck2\nproject."]}),"\n",(0,r.jsxs)(n.li,{children:["A ",(0,r.jsx)(n.a,{href:"/docs/concepts/build_rule",children:(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.em,{children:"build file"})})})," defines one or more build rules. In Buck2,\nbuild files are typically named ",(0,r.jsx)(n.code,{children:"BUCK"}),". A ",(0,r.jsx)(n.code,{children:"BUCK"})," file is analogous to the\n",(0,r.jsx)(n.code,{children:"Makefile"})," used by the Make utility. In your project, you will usually have a\nseparate ",(0,r.jsx)(n.code,{children:"BUCK"})," file for each buildable unit of software\u2014such as a binary or\nlibrary. For large projects, you could have hundreds of ",(0,r.jsx)(n.code,{children:"BUCK"})," files."]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["A Buck2 ",(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.em,{children:"package"})})," comprises of: a Buck2 build file (a ",(0,r.jsx)(n.code,{children:"BUCK"})," file), all\nfiles\u2014such as source files and headers\u2014in the same directory as the ",(0,r.jsx)(n.code,{children:"BUCK"})," file\nor in subdirectories, provided those subdirectories do not themselves contain a\n",(0,r.jsx)(n.code,{children:"BUCK"})," file. To say it another way, a ",(0,r.jsx)(n.code,{children:"BUCK"})," file defines the root of a package,\nbut Buck2 packages might not include all their subdirectories because Buck2\npackages do not overlap or contain other Buck2 packages. For example, in the\nfollowing diagram, the BUCK file in directory ",(0,r.jsx)(n.code,{children:"app-dir-1"})," defines that directory\nas the root of a package\u2014which is labeled ",(0,r.jsx)(n.strong,{children:"Package A"})," in the diagram. The\ndirectory ",(0,r.jsx)(n.code,{children:"app-dir-2"})," is part of Package A because it is a subdirectory of\n",(0,r.jsx)(n.code,{children:"app-dir-1"}),", but does not itself contain a BUCK file. Now, consider directory\n",(0,r.jsx)(n.code,{children:"app-dir-3"}),". Because ",(0,r.jsx)(n.code,{children:"app-dir-3"})," contains a BUCK file it is the root of a new\npackage (",(0,r.jsx)(n.strong,{children:"Package B"}),"). Although ",(0,r.jsx)(n.code,{children:"app-dir-3"})," is a subdirectory of ",(0,r.jsx)(n.code,{children:"app-dir-1"}),",\nit is ",(0,r.jsx)(n.em,{children:"not"})," part of Package A. Buck2 has the concept of a ",(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.em,{children:"cell"})}),", which\ndefines a directory tree of one or more Buck2 packages. A Buck2 build could\ninvolve multiple cells. Cells often correspond to repositories, but this isn't\nrequired. The root of a Buck2 cell contains a global configuration file called\n",(0,r.jsx)(n.a,{href:"/docs/concepts/buckconfig",children:(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.code,{children:".buckconfig"})})}),". Note that although the cell root should\ncontain a ",(0,r.jsx)(n.code,{children:".buckconfig"}),", the presence of a ",(0,r.jsx)(n.code,{children:".buckconfig"})," file doesn't in itself\ndefine a cell. Rather, ",(0,r.jsx)(n.em,{children:"the cells involved in a build are defined at the time\nBuck2 is invoked"}),"; they are specified in the ",(0,r.jsx)(n.code,{children:".buckconfig"})," for the Buck2\n",(0,r.jsx)(n.em,{children:"project"})," (see below). A Buck2 ",(0,r.jsx)(n.strong,{children:(0,r.jsx)(n.em,{children:"project"})})," is defined by the ",(0,r.jsx)(n.code,{children:".buckconfig"}),"\nwhere Buck2 is invoked, or if that directory doesn't contain a ",(0,r.jsx)(n.code,{children:".buckconfig"}),",\nthe project is defined by the ",(0,r.jsx)(n.code,{children:".buckconfig"})," in the nearest ancestor directory.\nThe ",(0,r.jsx)(n.code,{children:".buckconfig"})," for the project specifies the cells that constitute the Buck2\nproject. Specifically, these cells are specified in the\n",(0,r.jsx)(n.a,{href:"/docs/concepts/buckconfig#cells",children:"cells"})," section of the ",(0,r.jsx)(n.code,{children:".buckconfig"}),". Note that the\ndirectory tree rooted at this ",(0,r.jsx)(n.code,{children:".buckconfig"})," is automatically considered a cell\nby Buck2; in other words, the project's ",(0,r.jsx)(n.code,{children:".buckconfig"})," doesn't need to specify\nthe project cell explicitly\u2014although it is a good practice to do so."]}),"\n",(0,r.jsx)("img",{src:(0,c.default)("/img/packages-1.png"),alt:"justifyContent"}),"\n",(0,r.jsx)(n.h3,{id:"buck2s-dependency-graph",children:"Buck2's dependency graph"}),"\n",(0,r.jsxs)(n.p,{children:["Every build rule can have zero or more dependencies. You can specify these\ndependencies using, for example, the ",(0,r.jsx)(n.code,{children:"deps"})," argument to the build rule. For more\ninformation about specifying dependencies, consult the reference page for the\nbuild rule you are using. These dependencies form a directed graph, called the\n",(0,r.jsx)(n.em,{children:"target graph"}),'. Buck2 requires the graph to be acyclic. When building the output\nof a build rule, all of the rule\'s transitive dependencies are built first. This\nmeans that the graph is built in a "bottom-up" fashion. A build rule knows only\nwhich rules it depends on, not which rules depend on it. This makes the graph\neasier to reason about and enables Buck2 to identify independent subgraphs that\ncan be built in parallel. It also enables Buck2 to determine the minimal set of\nbuild targets that need to be rebuilt.']}),"\n",(0,r.jsx)(n.h3,{id:"multiple-buck2-projects-in-a-single-repository",children:"Multiple Buck2 projects in a single repository"}),"\n",(0,r.jsxs)(n.p,{children:["Buck2 is designed to build multiple deliverables from a single repository\u2014that\nis, a ",(0,r.jsx)(n.em,{children:"monorepo"}),"\u2014rather than from multiple repositories. Support for the\nmonorepo design motivated Buck2's support for cells and projects. It is\nFacebook's experience that maintaining all dependencies in the same repository\nmakes it easier to ensure that all developers have the correct version of the\ncode and simplifies the process of making atomic commits."]}),"\n",(0,r.jsx)(n.h3,{id:"see-also",children:"See also"}),"\n",(0,r.jsxs)(n.p,{children:["Take a look at the ",(0,r.jsx)(n.a,{href:"/docs/concepts/concept_map",children:"Concept Map"})," for a visualization of how\nBuck2 concepts interact with each other. Also see the ",(0,r.jsx)(n.a,{href:"/docs/concepts/glossary",children:"Glossary"}),"."]})]})}function h(e={}){const{wrapper:n}={...(0,o.useMDXComponents)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(u,{...e})}):u(e)}},15680:(e,n,t)=>{t.r(n),t.d(n,{MDXContext:()=>l,MDXProvider:()=>h,mdx:()=>g,useMDXComponents:()=>u,withMDXComponents:()=>d});var r=t(96540);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function c(){return c=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},c.apply(this,arguments)}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function s(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function a(e,n){if(null==e)return{};var t,r,o=function(e,n){if(null==e)return{};var t,r,o={},c=Object.keys(e);for(r=0;r<c.length;r++)t=c[r],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(r=0;r<c.length;r++)t=c[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var l=r.createContext({}),d=function(e){return function(n){var t=u(n.components);return r.createElement(e,c({},n,{components:t}))}},u=function(e){var n=r.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):s(s({},n),e)),t},h=function(e){var n=u(e.components);return r.createElement(l.Provider,{value:n},e.children)},p="mdxType",f={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},b=r.forwardRef((function(e,n){var t=e.components,o=e.mdxType,c=e.originalType,i=e.parentName,l=a(e,["components","mdxType","originalType","parentName"]),d=u(t),h=o,p=d["".concat(i,".").concat(h)]||d[h]||f[h]||c;return t?r.createElement(p,s(s({ref:n},l),{},{components:t})):r.createElement(p,s({ref:n},l))}));function g(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var c=t.length,i=new Array(c);i[0]=b;var s={};for(var a in n)hasOwnProperty.call(n,a)&&(s[a]=n[a]);s.originalType=e,s[p]="string"==typeof e?e:o,i[1]=s;for(var l=2;l<c;l++)i[l]=t[l];return r.createElement.apply(null,i)}return r.createElement.apply(null,t)}b.displayName="MDXCreateElement"}}]);