<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-developers/bxl_how_tos" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.5.1">
<title data-rh="true">Common How-Tos | Buck2</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://buck2.build/docs/developers/bxl_how_tos/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Common How-Tos | Buck2"><meta data-rh="true" name="description" content="Passing in and using CLI args"><meta data-rh="true" property="og:description" content="Passing in and using CLI args"><link data-rh="true" rel="icon" href="/img/logo.png"><link data-rh="true" rel="canonical" href="https://buck2.build/docs/developers/bxl_how_tos/"><link data-rh="true" rel="alternate" href="https://buck2.build/docs/developers/bxl_how_tos/" hreflang="en"><link data-rh="true" rel="alternate" href="https://buck2.build/docs/developers/bxl_how_tos/" hreflang="x-default"><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-GEGGHE39PE"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-GEGGHE39PE",{anonymize_ip:!0})</script><link rel="stylesheet" href="/assets/css/styles.c6c35c65.css">
<script src="/assets/js/runtime~main.81f3685b.js" defer="defer"></script>
<script src="/assets/js/main.7a8cf8da.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script>
<div style="display: none; text-align: center; background-color: white; color: black;" id="internaldocs-banner"></div><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Buck2 Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="Buck2 Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Buck2</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/">Docs</a><a class="navbar__item navbar__link" href="/docs/api/">API</a><a class="navbar__item navbar__link" href="/docs/prelude/globals/">Rules</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/facebook/buck2" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input id="search_input_react" type="search" placeholder="Loading..." aria-label="Search" class="navbar__search-input search-bar" disabled=""></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/about/why/">About Buck2</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/concepts/key_concepts/">Concepts</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/users/commands/aquery/">Buck2 Users</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/rule_authors/writing_rules/">Rule Authors</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/docs/developers/bxl/">BXL Developers</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/developers/bxl/">About BXL</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/docs/developers/bxl_getting_started/">User Guide</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/developers/bxl_getting_started/">Getting Started</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/developers/bxl_basics/">BXL Basics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/developers/bxl_how_tos/">Common How-Tos</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/developers/target_universe/">Target Universe in BXL</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/developers/bxl_telemetry/">BXL Telemetry</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/developers/anon_targets/">BXL and Anonymous Targets</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/developers/dynamic_output/">BXL and Dynamic Outputs</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/developers/bxl_faqs/">FAQs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/api/bxl/">BXL APIs</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/developers/architecture/buck2/">Buck2 Developers</a></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">BXL Developers</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">User Guide</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Common How-Tos</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Common How-Tos</h1></header><h2 id="passing-in-and-using-cli-args">Passing in and using CLI args</h2>
<p>A BXL function can accept a <code>cli_args</code> attribute where args names and types are
specified to use within your script, as shown in the following example:</p>
<p>Example:</p>
<pre><code class="language-python">def _impl_example(ctx):
    # ...
    pass

example = bxl_main(
    impl = _impl_example,
    cli_args = {
        # cli args that you want to receive from the command line
        &quot;bool_arg&quot;: cli_args.bool(),
        &quot;list_type&quot;: cli_args.list(cli_args.int()),
        &quot;optional&quot;: cli_args.option(cli_args.string()),
        &quot;target&quot;: cli_args.target_label(),
    },
)
</code></pre>
<p>On the command line, you can invoke the arguments as follows:</p>
<pre><code class="language-sh">buck2 bxl //myscript.bxl:example -- --bool_arg true --list_type 1 --list_type 2 --target //foo:bar
</code></pre>
<p>For BXL functions, to read the arguments, use them as attributes from the
<code>cli_args</code> attribute on the BXL <code>ctx</code> object, as follows:</p>
<pre><code class="language-python">def _impl_example(ctx):
    my_bool_arg = ctx.cli_args.bool_arg
</code></pre>
<h2 id="running-actions">Running actions</h2>
<p>You can create actions within BXL via the <code>actions_factory</code>. This is called once
globally then used on demand:</p>
<pre><code class="language-python">def _impl_example(ctx):
    actions = ctx.bxl_actions().actions # call once, reuse wherever needed
    output = actions.write(&quot;my_output&quot;, &quot;out&quot;)
</code></pre>
<p>You will need to have
<a href="/docs/rule_authors/configurations#execution-platforms">execution platforms</a>
enabled for your project, or else you will get an error. You can specify the
execution platform resolution by setting named parameters when instantiating
<code>bxl_actions</code>:</p>
<ul>
<li><code>exec_deps</code> - These are dependencies you wish to access as executables for
creating the action. This is usually the same set of targets one would pass to
rule&#x27;s <code>attr.exec_dep</code>. Accepts a list of strings, subtarget labels, target
labels, or target nodes.</li>
<li><code>toolchains</code> - The set of toolchains needed for the actions you intend to
create. Accepts a list of strings, subtarget labels, target labels, or target
nodes.</li>
<li><code>target_platform</code> - The intended target platform for your toolchains. Accepts
a string or target label.</li>
<li><code>exec_compatible_with</code> - Explicit list of configuration nodes (like platforms
or constraints) that these actions are compatible with. This is the
<code>exec_compatible_with</code> attribute of a target. Accepts a list of strings,
target labels, or target nodes.</li>
</ul>
<p>If you specify <code>exec_deps</code> or <code>toolchains</code>, you can access the resolved
<code>dependency</code> objects on the <code>bxl_actions</code> object. The <code>bxl_actions</code> object will
have <code>exec_deps</code> and <code>toolchains</code> attributes, which are <code>dict</code>s where the keys
are the unconfigured subtarget labels, and the values are the
configured/resolved <code>dependency</code> objects.</p>
<p>Note that the keys of <code>exec_deps</code> and <code>toolchains</code> must be unconfigured
subtarget labels (<code>StarlarkProvidersLabel</code>), and not unconfigured target labels.
You can use <code>ctx.unconfigured_sub_targets(...)</code> or <code>with_sub_target()</code> on
<code>target_label</code> to create the label.</p>
<pre><code class="language-python">def _impl_example(ctx):
    my_exec_dep = ctx.unconfigured_sub_targets(&quot;foo//bar:baz&quot;) # has some provider that you would use in the action
    bxl_actions = ctx.bxl_actions(exec_deps = [my_exec_dep]) # call once, reuse wherever needed
    output = bxl_actions.actions.run(
        [
            &quot;python3&quot;,
            bxl_actions.exec_deps[my_exec_dep][RunInfo], # access resolved exec_deps on the `bxl_actions`
            out.as_output(),
        ],
        category = &quot;command&quot;,
        local_only = True,
    )
    ctx.output.ensure(output)
</code></pre>
<h2 id="getting-providers-from-an-analysis">Getting providers from an analysis</h2>
<p>After calling <code>analysis()</code>, you can get the providers collection from
<code>providers()</code>:</p>
<pre><code class="language-python">def _impl_example(ctx):
    my_providers = ctx.analysis(my_target).providers()
</code></pre>
<h2 id="get-a-specific-provider-from-an-analysis">Get a specific provider from an analysis</h2>
<p>After calling <code>analysis()</code>, you can also get the providers collection from
<code>providers()</code> then grab whatever specific provider you need:</p>
<pre><code class="language-python">def _impl_example(ctx):
    default_info = ctx.analysis(my_target).providers()[DefaultInfo]
    ctx.output.print(default_info)
</code></pre>
<h2 id="get-a-specific-subtarget-from-an-analysis">Get a specific subtarget from an analysis</h2>
<p>Once you have a provider, you can get its subtargets by using the <code>sub_targets</code>
attribute on the struct to get a dict of provider labels to provider
collections:</p>
<pre><code class="language-python">def _impl_example(ctx):
    subtarget = ctx.analysis(my_target).providers()[DefaultInfo].sub_targets[&quot;my_subtarget&quot;]
    ctx.output.print(subtarget)
</code></pre>
<h2 id="building-a-targetsubtarget-without-blocking">Building a target/subtarget without blocking</h2>
<p><code>ctx.build</code> is synchronous and should only be used when the result of the build
is needed inline during the bxl execution. To execute builds without blocking
the script, retrieve the <code>DefaultInfo</code> from the target&#x27;s providers and use the
<code>ctx.output.ensure_multiple</code> api.</p>
<p>Example:</p>
<pre><code class="language-python">ctx.output.ensure_multiple(ctx.analysis(label).providers()[DefaultInfo])
</code></pre>
<h2 id="getting-attributes-or-resolved-attributes-efficiently-on-a-configured-target-node">Getting attributes or resolved attributes efficiently on a configured target node</h2>
<p>If you need to use all of the attrs/resolved_attrs, then initializing the eager
variant once would be best. If you only need a few of the attrs, then
initializing the lazy variant is better. There’s not really a hard line, it
depends on the target node, and which attrs you are looking for. If performance
is key to your BXL script, the best way to determine this is to use the BXL
profiler.</p>
<p>Regardless, if you use eager or lazy versions of getting attributes, you should
cache the attrs object:</p>
<pre><code class="language-python">def _impl_example(ctx):
    my_configured_node = ctx.configured_targets(&quot;:foo&quot;)

    # call once and resue, ideally when you need most/all attrs
    eager = my_configured_node.attrs_eager()

    # call once and reuse, ideally when you only need a few attrs
    lazy = my_configured_node.attrs_lazy()

    # call once and reuse, ideally when you need most/all resolved attrs
    resolved_eager = my_configured_node.resolved_attrs_eager(ctx)

    # call once and reuse, ideally when you only need a few resolved attrs
    resolved_lazy = my_configured_node.resolved_attrs_lazy(ctx)
</code></pre>
<h2 id="inspecting-a-struct">Inspecting a struct</h2>
<p>You can use <code>dir(my_struct)</code> to inspect a struct. You can also use
<code>getattr(my_struct, &quot;my_attr&quot;)</code> to grab individual attributes, which is
equivalent to <code>my_struct.my_attr</code>.</p>
<p>These are available as part of the
<a href="https://github.com/bazelbuild/starlark/blob/master/spec.md#dir">Starlark language spec</a>.</p>
<h2 id="set-additionsubtraction-on-a-target_set">Set addition/subtraction on a <code>target_set</code></h2>
<p>There are a few BXL actions that return a <code>target_set</code> (such as a cquery
<code>eval()</code>). The <code>target_set</code> supports set subtraction and addition (you can use
<code>-</code> and <code>+</code> directly in Starlark).</p>
<h2 id="initializing-configuredunconfigured-target_set">Initializing configured/unconfigured <code>target_set</code></h2>
<p>You can use following apis to initialize <code>target_set</code></p>
<pre><code class="language-python">def bxl.utarget_set(nodes: None | list[bxl.UnconfiguredTargetNode]) -&gt; bxl.UnconfiguredTargetSet
</code></pre>
<pre><code class="language-python">def bxl.ctarget_set(nodes: None | list[bxl.ConfiguredTargetNode]) -&gt; bxl.ConfiguredTargetSet
</code></pre>
<h2 id="profiling-testing-and-debugging-a-bxl-script">Profiling, Testing, and Debugging a BXL script</h2>
<p>You can use <code>buck2 bxl profiler</code>, with various measurements, to determine where
the script is least efficient.</p>
<p>To time individual pieces of the script, you can use BXL’s timestamp methods:</p>
<pre><code class="language-python">def _impl_example(_ctx):
    start = now() # call once and reuse wherever is necessary
    # do something time intensive here
    end1 = start.elapsed_millis()
    # do something else time intensive here
    end2 = start.elapsed_millis()
</code></pre>
<ul>
<li><strong>Debug</strong> - the common way to debug a BXL script is with print statements
(<code>print()</code>, <code>pprint()</code> and <code>ctx.output.print()</code>).</li>
</ul>
<!-- -->
<ul>
<li><strong>Test</strong> - BXL does not have a robust testing framework for mocking. The main
method to test a BXL script is to actually invoke it with required inputs then
verify the outputs.</li>
</ul>
<h2 id="getting-the-path-of-an-artifact-as-a-string">Getting the path of an artifact as a string</h2>
<p>The starlark <code>artifact</code> type encapsulates source artifacts, declared artifacts,
and build artifacts. It can be dangerous to access paths and use them in further
BXL computations. For example, if you are trying to use absolute paths for
something and end up passing it into a remotely executed action, the absolute
path may not exist on the remote machine. Or, if you are working with paths and
expecting the artifact to already have been materialized in further BXL
computations, that would also result in errors.</p>
<p>However, if you are not making any assumptions about the existence of these
artifacts, you can use use
<a href="../../api/bxl#get_path_without_materialization"><code>get_path_without_materialization()</code></a>,
which accepts source, declared, or build aritfacts. It does <em>not</em> accept ensured
artifacts (also see
<a href="/docs/developers/bxl_faqs#what-do-i-need-to-know-about-ensured-artifacts">What do I need to know about ensured artifacts</a>).</p>
<p>For getting paths of <code>cmd_args()</code> inputs, you can use
<a href="../../api/bxl#get_paths_without_materialization"><code>get_paths_without_materialization()</code></a>,
but note this is risky because the inputs could contain tsets, which, when
expanded, could be very large. Use these methods at your own risk.</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/developers/bxl_basics/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">BXL Basics</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/developers/target_universe/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Target Universe in BXL</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#passing-in-and-using-cli-args" class="table-of-contents__link toc-highlight">Passing in and using CLI args</a></li><li><a href="#running-actions" class="table-of-contents__link toc-highlight">Running actions</a></li><li><a href="#getting-providers-from-an-analysis" class="table-of-contents__link toc-highlight">Getting providers from an analysis</a></li><li><a href="#get-a-specific-provider-from-an-analysis" class="table-of-contents__link toc-highlight">Get a specific provider from an analysis</a></li><li><a href="#get-a-specific-subtarget-from-an-analysis" class="table-of-contents__link toc-highlight">Get a specific subtarget from an analysis</a></li><li><a href="#building-a-targetsubtarget-without-blocking" class="table-of-contents__link toc-highlight">Building a target/subtarget without blocking</a></li><li><a href="#getting-attributes-or-resolved-attributes-efficiently-on-a-configured-target-node" class="table-of-contents__link toc-highlight">Getting attributes or resolved attributes efficiently on a configured target node</a></li><li><a href="#inspecting-a-struct" class="table-of-contents__link toc-highlight">Inspecting a struct</a></li><li><a href="#set-additionsubtraction-on-a-target_set" class="table-of-contents__link toc-highlight">Set addition/subtraction on a <code>target_set</code></a></li><li><a href="#initializing-configuredunconfigured-target_set" class="table-of-contents__link toc-highlight">Initializing configured/unconfigured <code>target_set</code></a></li><li><a href="#profiling-testing-and-debugging-a-bxl-script" class="table-of-contents__link toc-highlight">Profiling, Testing, and Debugging a BXL script</a></li><li><a href="#getting-the-path-of-an-artifact-as-a-string" class="table-of-contents__link toc-highlight">Getting the path of an artifact as a string</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/">User guide</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/facebook/buck2/issues" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub issues<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/facebook/buck2" target="_blank" rel="noopener noreferrer" class="footer__link-item">Code<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://opensource.fb.com/legal/terms" target="_blank" rel="noopener noreferrer" class="footer__link-item">Terms of Use<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://opensource.fb.com/legal/privacy" target="_blank" rel="noopener noreferrer" class="footer__link-item">Privacy Policy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Meta Platforms, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>